Adicionamos todos os dados nas nossas tabelas e, agora, vamos aprender como visualizá-los em tabelas MySQL. No nosso Notebook, na seção "Visualizando os dados inseridos", vamos utilizar o comando Select do SQL para visualizar os dados.

Chamaremos o nosso cursor através do comando cursor.execute(), abrindo parênteses e aspas. Como desejamos visualizar todos os dados inseridos em uma tabela, vamos utilizar o comando SELECT *, onde o asterisco representa todos os dados. Esse comando será seguido pelo nome da nossa base de dados (dbprodutos), ponto seguido do nome da nossa tabela (tb_livros):

cursor.execute("SELECT * FROM dbprodutos.tb_livros;")
Copiar código
É importante lembrar que este cursor funciona como um iterador. Para percorrer os resultados retornados por essa seleção, utilizaremos um for da seguinte forma:

for row in cursor:
    print(row)
Copiar código
Ao executar este código, teremos como resultado os dados que estão na nossa tabela atualmente. No entanto, cada linha é retornada individualmente em tuplas, o que pode não ser a maneira ideal de visualização.

Uma solução interessante para esse problema é visualizar esses dados diretamente nas tabelas do MySQL. Podemos fazer isso no próprio VS Code utilizando uma extensão. Para instalá-la, basta ir na seção de extensões do VS Code, digitar "mysql" na barra de pesquisa e selecionar a segunda opção disponível que possui o ícone oficial: MySQL criada por Weijan Chen.

Ao clicar nesta opção, selecione a opção "Install" para instalar a extensão.

Uma vez instalada a extensão, feche a aba que se abriu e observe que passamos a ter um novo ícone na barra lateral esquerda do VS Code. Este ícone de Database é uma funcionalidade que veio dessa extensão e nós nos concentraremos nela.

Ao clicar nesse ícone, abrem-se outras opções na barra lateral esquerda e podemos criar uma conexão com o nosso banco de dados MySQL. Podemos clicar no botão "Create Connection".

Será aberta uma tela na qual criaremos a conexão do VS Code com o banco de dados. O primeiro campo a ser preenchido é o "Name", onde nomearemos essa conexão como db_connection. Na seção de "Server Type" podemos confirmar que estamos utilizando o MySQL, o que já deve estar selecionado.

Por fim, preencheremos com as informações do usuário criado no nosso MySQL. Vamos preencher os campos "Host", "Username" e "Password".

Host: localhost

Username: millenagena

Password: 12345

Em seguida, podemos descer até as últimas opções, clicar em "Save" para salvar essa conexão e em "Connect".

Note que, na nossa barra lateral esquerda, apareceu a nossa conexão db_connection. Há um círculo verde bem pequeno ao lado do nome da nossa conexão, o que indica que salvamos a conexão e também estamos conectados a ela.

Se clicarmos nessa conexão e fecharmos a aba "Connect" que está aberta, veremos a nossa base de dados dbprodutos. Ao clicar nela, encontramos várias opções - a que nos interessa neste momento são as tabelas existentes nessa base de dados, que podem ser conferidas na segunda opção: Tables.

Analisando, temos duas tabelas - tb_livros, que foi criada anteriormente, e tb_produtos_2021_em_diante, que foi criada na atividade que deixei nessa aula. Agora, vamos visualizar os dados da nossa tabela tb_livros. Para isso, vamos dar dois cliques nela.

Na parte de cima, está sendo feita uma seleção e a visualização foi limitada a 100 linhas:

SELECT * FROM tb_livros LIMIT 100
Copiar código
Agora conseguimos visualizar a tabela tb_livros no VS Code. Podemos arrastar para o lado que veremos todas as colunas. Nós também conseguimos visualizar os tipos de cada uma delas. Na primeira coluna, que é o ID, temos um asterisco em vermelho, representando que o id é a nossa primary key, conforme foi definido no momento de criação dessa tabela.

Embora tenhamos apenas 100 linhas visualizadas, devido à limitação de visualização, temos o total de linhas, que é 742, logo acima da coluna Data_Compra.

Agora, vamos visualizar rapidamente a nossa outra tabela, a tb_produtos_2021_em_diante. Para isso, clico novamente no ícone "Database" que está no menu lateral à esquerda, vou à nossa conexão, fecho a tb_livros e clico na tb_produtos_2021_em_diante.

Está sendo exibida no VS Code a nossa outra tabela, que foi criada na atividade. No topo, é possível visualizar que ela possui um total de 6.574 linhas.

É interessante visualizar as tabelas dessa maneira pelo Visual Studio Code, não é?

Para finalizar, podemos voltar rapidamente ao nosso notebook save_data_mysql.ipynb, descer até as últimas células para fechar o nosso cursor,cursor.close(), e também fechar a nossa conexão com cnx.close(). Também podemos pressionar "Ctrl + S" para salvar esse notebook.

cursor.close()
Copiar código
cnx.close()
Copiar código
Conclusão
Pronto! Fizemos tudo o que foi solicitado no pipeline.

Extraímos os dados dos produtos vendidos dessa empresa de e-commerce de uma API;
Armazenamos no MongoDB para que o time de Data Science tenha acesso a esses dados;
Aplicamos as transformações solicitadas pelo time de BI nos dados;
E armazenamos todos eles em tabelas no MySQL para que esse outro time tenha acesso aos dados da forma que eles precisam.

