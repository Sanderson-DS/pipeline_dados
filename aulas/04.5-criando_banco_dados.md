Já realizamos a conexão do MySQL com o Python, mas como podemos criar uma base de dados no MySQL utilizando Python? Entenderemos isso agora!

Criando um banco de dados
No notebook save_data_mysql.ipynb, trabalharemos na seção "Criando uma base de dados". Para executar uma instrução SQL usando Python, temos que utilizar o método execute(). Vamos entender como ele funciona?

Em uma nova célula, utilizaremos o cursor definido anteriormente. Portanto, vamos digitar cursor.execute() e, entre parênteses e aspas, passaremos o comando que queremos executar.

Neste caso, queremos fazer a criação do banco de dados, onde, posteriormente, armazenaremos as tabelas com os dados. Para criar um banco de dados, utilizamos o comando CREATE DATABASE e colocamos o nome que desejamos dar para o banco. Como estamos trabalhando com dados de produtos, vamos chamá-lo de dbprodutos e adicionaremos ponto e vírgula na sequência.

Antes de executar esse comando, vamos acrescentar IF NOT EXISTS entre CREATE DATABASE e o nome do banco de dados dbprodutos.

cursor.execute("CREATE DATABASE IF NOT EXISTS dbprodutos;")
Copiar código
A função de IF NOT EXISTS é evitar a duplicação da base de dados. Se o banco de dados nomeado como dbprodutos já existe, ele não será criado novamente.

Isso é útil porque, no SQL, se tentamos criar um novo banco de dados com o nome de um banco já existente, recebemos um erro. Portanto, usamos esse termo para evitar qualquer erro caso a célula seja executada novamente mais adiante.

Executaremos o comando pressionando "Shift + Enter".

Nada será retornado para nós, então precisamos executar outro comando para verificar se o banco de dados foi efetivamente criado. No SQL, podemos usar o comando SHOW DATABASES por meio do método execute() em uma nova célula.

cursor.execute("SHOW DATABASES;")
Copiar código
O cursor funciona como um iterador sobre os resultados retornados pelas instruções SQL. Como o comando SHOW DATABASES retornará mais de um valor, pois mostrará os nomes de todos os bancos de dados que temos no SQL, precisamos utilizar um laço for para percorrer o cursor e visualizar todos os resultados retornados por essa instrução SQL.

Dito isso, na linha seguinte da mesma célula, vamos digitar for db in cursor:, e na linha abaixo, usar o método print() recebendo a variável db.

cursor.execute("SHOW DATABASES;")

for db in cursor:
    print(db)
Copiar código
Dessa forma, percorreremos todos os resultados retornados pelo comando SHOW DATABASES por meio da variável db. Executada a célula, a instrução retornará várias bases de dados.

('dbprodutos',)
('information_schema',)
('mysql',)
('performance_schema',)
('sys',)
Copiar código
Essas bases de dados são criadas por padrão quando instalamos o MySQL, mas a que nos interessa é a dbprodutos, mostrada logo no início do retorno. Se o nome dela aparece nos resultados, significa que conseguimos criar este banco de dados com sucesso.

Feito isso, podemos salvar o notebook com o atalho "Ctrl + S".

Conclusão
Com o banco de dados criado, podemos partir para a criação das tabelas!
