Transcrição
Depois de criar nosso banco de dados no MongoDB, precisamos extrair os dados que, atualmente, estão em uma API, para conseguir inseri-los mais tarde nesse banco de dados. Vamos lá.

Extraindo os Dados da API
Com o nosso notebook extract_and_save_data.ipynb aberto no VS Code, acessaremos a seção nomeada como "Extraindo os dados da API". Para extrair os dados da API utilizando o Python, vamos usar a biblioteca requests.

Vamos começar acessando a primeira célula da seção atual, onde importaremos essa biblioteca.

import requests
Copiar código
Essa biblioteca já foi instalada em uma das atividades da aula 1, denominada "Preparando o Ambiente", onde nós instalamos todas as bibliotecas que vamos utilizar aqui no decorrer do projeto.

Podemos pular uma linha e criar uma variável chamada response, na qual vamos armazenar o retorno da API. Ela receberá uma requisição do tipo get para obter os dados que estão na API. Entre parênteses e aspas duplas, passaremos o argumento da função get que é o endpoint (URL) dessa API para obter acesso aos dados: https://labdados.com/produtos.

https://labdados.com/produtos
Copiar código
O resultado dessa célula pode ser consultado abaixo.

import requests

response = requests.get("https://labdados.com/produtos")
Copiar código
Para visualizar a resposta dessa requisição, vamos usar um response.json() na próxima linha, o que vai ser responsável por apresentar os resultados dessa extração de dados.

import requests

response = requests.get("https://labdados.com/produtos")
response.json()
Copiar código
Vamos pressionar "Shift+Enter" para executar essa célula. Após aguardar um pouco, veremos como retorno os dados extraídos da API.

[{'Produto': 'Modelagem preditiva',

'Categoria do Produto': 'livros',

'Preço': 92.45,

'Frete': 5.6096965236,

'Data da Compra': '01/01/2020',

'Vendedor': 'Thiago Silva',

'Local da compra': 'BA',

'Avaliação da compra': 1,

'Tipo de pagamento': 'cartao_credito',

'Quantidade de parcelas': 3,

'lat': -13.29,

'lon': -41.71},

Retorno omitido

]

Eles estão no formato JSON e possuem diversas informações sobre os produtos vendidos, temos os campos de produto, categoria, preço, frete, data da compra e mais algumas outras informações.

Vamos acessar a próxima célula, abaixo desse retorno, e verificar quantos dados nós extraímos dessa API. Para isso, podemos utilizar a função len() do próprio Python. Entre os parênteses, informaremos o response.json() com os dados extraídos da API.

len(response.json())
Copiar código
Executando essa célula, ele retornará que extraímos um total de 9.435 dados.

9435

É importante ter essa informação da quantidade de dados extraídos para, posteriormente, quando nós inserirmos esses dados no banco de dados do MongoDB, podermos verificar se as quantidades são compatíveis — ou seja, se inserimos a mesma quantidade de dados que extraímos.

Podemos salvar esse notebook pressionando "Ctrl+S". Com os dados extraídos, podemos seguir para o próximo passo: inseri-los no banco de dados.
